@using Transformer_Forecasting_Web.Data;

<MudDialog Style="@($"background:{Theme.Palette.BackgroundGrey};")">
    <DialogContent>
        Dialog Content
    </DialogContent>

    <DialogActions>
        @if (showWarning == true)
        {
            <MudAlert Severity="Severity.Warning" Variant="Variant.Filled" Class="">Must fill all boxes</MudAlert>
        }
        <MudButton OnClick="Cancel">Cancel</MudButton>        
        <MudButton Color="Color.Primary" OnClick="Submit">Ok</MudButton>
    </DialogActions>

    <DialogContent>
    <MudStack>
            <MudPaper Class="pa-4">
            <MudText Typo="Typo.body1">Model</MudText>
            <MudSelect T="string" Label="Pick a model" @bind-Value="model">
                <MudSelectItem T="string" Value="@("DTP")" />
                <MudSelectItem T="string" Value="@("LFP")" />
            </MudSelect>
        </MudPaper>

        <MudPaper Class="pa-4">
            <MudText Typo="Typo.body1">Period Description</MudText>
            <MudTextField  Lines="3" @bind-Value="periodDescription" Label="Describe the period" Variant="Variant.Text" />
        </MudPaper>

        <MudPaper Class="pa-4">
            <MudText Typo="Typo.body1">Predict Ahead</MudText>
            <MudStack Spacing="4">
                <MudText Typo="Typo.body2">From:
                    <MudDatePicker Label="From date" @bind-Date="FromDate" />
                    <MudTimePicker Label="From time" @bind-Time="FromTime" />
                </MudText>

                <MudText Typo="Typo.body2">To:
                    <MudDatePicker Label="To date" @bind-Date="ToDate" />
                    <MudTimePicker Label="To time" @bind-Time="ToTime" />
                </MudText>
            </MudStack>
        </MudPaper>
    </MudStack>
    </DialogContent>

</MudDialog>




@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    private bool visibility = false;
    private string model = "";
    private string periodDescription = "";
    private DateTime? FromDate;
    private TimeSpan? FromTime;
    private DateTime? ToDate;
    private TimeSpan? ToTime;
    bool showWarning = false;
    int id = 1; //Should be changed to fit with database

    Prediction prediction = new Prediction();
    private MudTheme Theme = new MudTheme();


    void Submit()
    {
        prediction = new Prediction(id, model, periodDescription, FromDate + FromTime, ToDate + ToTime, new double[] { 1, 5, 3, 4, 2, 5 }, new double[] { 7, 6, 4, 2, 3, 4 }); //insert predicted values here
        id++;
        if(prediction.Model != "" && prediction.PeriodDescription != "" && prediction.StartDate != null && prediction.EndDate != null)
        {
            MudDialog.Close(DialogResult.Ok(true));
        }
        else
        {
            showWarning = true;
        }
    }
    void Cancel() => MudDialog.Cancel();
}